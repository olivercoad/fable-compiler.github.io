<html class="has-navbar-fixed-top" lang="en"><head><title>Fable Â· Call JS from Fable</title><meta http-equiv="content-type" content="text/html; charset=UTF-8" charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" type="text/css" href="/style.css"/><script src="https://unpkg.com/scroll-into-view-if-needed@2.2.28/umd/scroll-into-view-if-needed.min.js"></script></head><body><nav class="navbar is-fixed-top is-spaced"><div class="container"><div class="navbar-brand"><a class="navbar-item title is-4" href="https://fable.io/">Fable</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/docs">Documentation</a><a class="navbar-item is-hidden-mobile" href="/repl/">Try</a><a class="navbar-item" href="/blog/index.html">Blog</a><a class="navbar-item is-hidden-mobile" href="/community.html">Community</a><a class="navbar-item is-hidden-mobile" href="/resources.html">Resources</a><div class="navbar-item navbar-burger-dots is-hidden-tablet"><svg height="4" stroke="none" viewBox="0 0 22 4" width="22"><circle cx="2" cy="2" r="2"></circle><circle cx="2" cy="2" r="2" transform="translate(9,0)"></circle><circle cx="2" cy="2" r="2" transform="translate(18,0)"></circle></svg></div></div><div class="navbar-end is-hidden-mobile"><a class="navbar-item" href="https://github.com/fable-compiler/fable"><span class="icon"><i class=" fab fa-github fa-lg"></i></span></a><a class="navbar-item" href="https://twitter.com/FableCompiler"><span class="icon"><i class=" fab fa-twitter fa-lg"></i></span></a><a class="navbar-item" href="https://gitter.im/fable-compiler/Fable"><span class="icon"><i class=" fab fa-gitter fa-lg"></i></span></a><a class="navbar-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos"><span class="icon"><i class=" fab fa-youtube fa-lg"></i></span></a></div></div><div class="nacara-navbar-menu"><a class="nacara-navbar-menu-item" href="/repl/">Try</a><a class="nacara-navbar-menu-item" href="/community.html">Community</a><a class="nacara-navbar-menu-item" href="/resources.html">Resources</a><a class="nacara-navbar-menu-item" href="https://github.com/fable-compiler/fable">Github</a><a class="nacara-navbar-menu-item" href="https://twitter.com/FableCompiler">Twitter</a><a class="nacara-navbar-menu-item" href="https://gitter.im/fable-compiler/Fable">Gitter</a><a class="nacara-navbar-menu-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos">Youtube</a></div></div></nav><div class="grey-overlay"></div><div class="nacara-content"><div class="container"><div class="mobile-menu"><nav class="breadcrumb"><ul><li><a class="menu-trigger"><span></span><span></span><span></span></a></li><li class="is-active"><a>Documentation</a></li><li class="is-active"><a>Communicate with Javascript</a></li><li class="is-active"><a>Call JS from Fable</a></li></ul></nav></div><div class="columns is-gapless is-mobile"><div class="column is-menu-column is-3-desktop is-hidden-touch"><div class="menu-container"><aside class="menu"><p class="menu-label">Introduction</p><ul class="menu-list"><li><a class=" " href="/docs/index.html">What is Fable?</a></li><li><a class=" " href="/docs/introduction/dotnet-users-read-this.html">Are you a .NET developer?</a></li><li><a class=" " href="/docs/introduction/js-users-read-this.html">Are you a JS developer?</a></li></ul><p class="menu-label">New to F#?</p><ul class="menu-list"><li><a class=" " href="/docs/new-to-fsharp/learning-the-language.html">Learning the language</a></li><li><a class=" " href="/docs/new-to-fsharp/let-keyword.html">The let keyword</a></li></ul><p class="menu-label">Fable in 2 steps</p><ul class="menu-list"><li><a class=" " href="/docs/2-steps/setup.html">Setup</a></li><li><a class=" " href="/docs/2-steps/your-first-fable-project.html">Start a new project</a></li></ul><p class="menu-label">Your Fable project</p><ul class="menu-list"><li><a class=" " href="/docs/your-fable-project/project-file.html">The project file</a></li><li><a class=" " href="/docs/your-fable-project/use-a-fable-library.html">Use a Fable library</a></li><li><a class=" " href="/docs/your-fable-project/author-a-fable-library.html">Author a Fable library</a></li><li><a class=" " href="/docs/your-fable-project/build-and-run.html">Build &amp; run</a></li><li><a class=" " href="/docs/your-fable-project/testing.html">Testing</a></li></ul><p class="menu-label">Communicate with Javascript</p><ul class="menu-list"><li><a class=" is-active" href="/docs/communicate/js-from-fable.html">Call JS from Fable</a></li><li><a class=" " href="/docs/communicate/fable-from-js.html">Call Fable from JavaScript</a></li></ul><p class="menu-label">From .NET to Fable</p><ul class="menu-list"><li><a class=" " href="/docs/dotnet/compatibility.html">.NET and F# compatibility</a></li><li><a class=" " href="/docs/dotnet/numbers.html">Numeric types</a></li></ul><p class="menu-label">Miscellaneous</p><ul class="menu-list"><li><a class=" " href="/docs/miscellaneous/official-samples.html">Check official samples</a></li><li><a class=" " href="/docs/miscellaneous/fable-in-videos.html">Fable in videos</a></li></ul></aside></div></div><div class="column is-8-desktop is-full-touch"><section class="section"><div class="content"><header class="page-header"><div class="columns is-vcentered"><div class="column"><nav class="breadcrumb is-category-navigation is-hidden-touch"><ul><li class="is-active"><a>Documentation</a></li><li class="is-active"><a>Communicate with Javascript</a></li><li class="is-active"><a>Call JS from Fable</a></li></ul></nav></div><div class="column is-narrow"><a class="button is-hidden-touch is-ghost" target="_blank" href="https://github.com/fable-compiler/fable-compiler.github.io/edit/dev/docs/docs/communicate/js-from-fable.md">Edit</a></div></div><h1 class="title is-1">Call JS from Fable</h1></header><div><style class=grvsc-styles>.grvsc-container{overflow:auto;position:relative;-webkit-overflow-scrolling:touch;padding-top:1rem;padding-top:var(--grvsc-padding-top,var(--grvsc-padding-v,1rem));padding-bottom:1rem;padding-bottom:var(--grvsc-padding-bottom,var(--grvsc-padding-v,1rem));border-radius:8px;border-radius:var(--grvsc-border-radius,8px);font-feature-settings:normal;line-height:1.4}.grvsc-code{display:table}.grvsc-line{display:table-row;box-sizing:border-box;width:100%;position:relative}.grvsc-line>*{position:relative}.grvsc-gutter-pad{display:table-cell;padding-left:.75rem;padding-left:calc(var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem))/ 2)}.grvsc-gutter{display:table-cell;-webkit-user-select:none;-moz-user-select:none;user-select:none}.grvsc-gutter::before{content:attr(data-content)}.grvsc-source{display:table-cell;padding-left:1.5rem;padding-left:var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem));padding-right:1.5rem;padding-right:var(--grvsc-padding-right,var(--grvsc-padding-h,1.5rem))}.grvsc-source:empty::after{content:' ';-webkit-user-select:none;-moz-user-select:none;user-select:none}.grvsc-gutter+.grvsc-source{padding-left:.75rem;padding-left:calc(var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem))/ 2)}.grvsc-has-line-highlighting>.grvsc-code>.grvsc-line::before{content:' ';position:absolute;width:100%}.grvsc-line-diff-add::before{background-color:var(--grvsc-line-diff-add-background-color,rgba(0,255,60,.2))}.grvsc-line-diff-del::before{background-color:var(--grvsc-line-diff-del-background-color,rgba(255,0,20,.2))}.grvsc-line-number{padding:0 2px;text-align:right;opacity:.7}.atom-one-light{background-color:#fafafa;color:#383a42}.atom-one-light .mtki{font-style:italic}.atom-one-light .mtk7{color:#a0a1a7}.atom-one-light .mtk8{color:#0184bc}.atom-one-light .mtk14{color:#a626a4}.atom-one-light .mtk10{color:#50a14f}.atom-one-light .mtk1{color:#383a42}.atom-one-light .mtk9{color:#4078f2}.atom-one-light .mtk5{color:#e45649}.atom-one-light .mtk4{color:#c18401}.atom-one-light .mtk6{color:#986801}.atom-one-light .grvsc-line-highlighted::before{background-color:var(--grvsc-line-highlighted-background-color,rgba(0,0,0,.05));box-shadow:inset var(--grvsc-line-highlighted-border-width,4px) 0 0 0 var(--grvsc-line-highlighted-border-color,rgba(0,0,0,.2))}</style><h2 id=call-javascript-from-fable>Call JavaScript from Fable<a href=#call-javascript-from-fable aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h2><p>Interoperability is a matter of trust between your statically typed F# code and your untyped dynamic JS code. In order to mitigate risks, Fable gives you several possibilities, amongst them type safety through interface contracts. Sometimes it may sound more convenient to just call JS code in a more dynamic fashion, although be aware by doing this potential bugs will not be discovered until runtime.<p>We'll describe both the safe way and the dynamic way and then it will be up to you to decide. Let's start!<h3 id=adding-the-js-library-to-the-project>Adding the JS library to the project<a href=#adding-the-js-library-to-the-project aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h3><p>The very first thing to do is add the library to our project. Since we always have a <code>package.json</code> file, we'll just add the wanted library to our project using either <code>npm install my-awesome-js-library</code>. The library will then be available in the <code>node_modules</code> folder.<blockquote><p>If your library is in a file, just skip this step.</blockquote><h3 id=type-safety-with-imports-and-interfaces>Type safety with Imports and Interfaces<a href=#type-safety-with-imports-and-interfaces aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h3><p>To use code from JS libraries first you need to import it into F#. For this Fable uses <a href=https://developer.mozilla.org/en/docs/web/JavaScript/reference/statements/import>ES2015 imports</a>, which can be later transformed to other JS module systems like <code>commonjs</code> or <code>amd</code> by <a href=https://babeljs.io/docs/en/plugins#modules>Babel</a>.<p>There are two ways to declare ES2015 imports in Fable: by using either the <strong>Import attribute</strong> or the <strong>import expressions</strong>. The <code>ImportAttribute</code> can decorate members, types or modules and works as follows:<pre class="atom-one-light grvsc-container"data-index=0 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Namespace imports</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60Import</span><span class=mtk14>(</span><span class=mtk10>"*"</span><span class=mtk14>,</span><span class=mtk8> from</span><span class=mtk14>=</span><span class=mtk10>"my-module"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// import * from "my-module"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Member imports</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60Import</span><span class=mtk14>(</span><span class=mtk10>"myFunction"</span><span class=mtk14>,</span><span class=mtk8> from</span><span class=mtk14>=</span><span class=mtk10>"my-module"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// import { myFunction } from "my-module"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Default imports</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60Import</span><span class=mtk14>(</span><span class=mtk10>"default"</span><span class=mtk14>,</span><span class=mtk8> from</span><span class=mtk14>=</span><span class=mtk10>"express"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// import Express from "express"</span></span></span></code></pre><p>You can also use the following alias attributes:<pre class="atom-one-light grvsc-container"data-index=1 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Same as Import("*", "my-module")</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60ImportAll</span><span class=mtk14>(</span><span class=mtk10>"my-module"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>myModule</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>obj </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Same as Import("default", "my-module")</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60ImportDefault</span><span class=mtk14>(</span><span class=mtk10>"my-module"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>myModuleDefaultExport</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>obj </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// The member name is taken from decorated value, here `myFunction`</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60ImportMember</span><span class=mtk14>(</span><span class=mtk10>"my-module"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>myFunction</span><span class=mtk14>(</span><span class=mtk1>x</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>int </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span></code></pre><p>If the value is globally accessible in JS, you can use the <code>Global</code> attribute with an optional name parameter instead.<pre class="atom-one-light grvsc-container"data-index=2 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk8> [&#60Global>]</span><span class=mtk1> </span><span class=mtk5>console</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>JS.Console </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// You can pass a string argument if you want to use a different name in your F# code</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk8> [&#60Global("console")>]</span><span class=mtk1> </span><span class=mtk5>logger</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>JS.Console </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span></code></pre><h4 id=importing-relative-paths-when-using-an-output-directory>Importing relative paths when using an output directory<a href=#importing-relative-paths-when-using-an-output-directory aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h4><p>If you are putting the generated JS files in an output directory using Fable's <code>-o</code> option, be aware that Fable will only move files corresponding to .fs sources, not external files like .js or .css. Fable will automatically adjust relative paths in imports to the location of the generated file, but sometimes it's difficult to know where the generated file will end up exactly. In these cases, it's useful to use the <code>${outDir}</code> macro which will be replaced by the output directory. For example, if we are importing a CSS module like this:<pre class="atom-one-light grvsc-container"data-index=3 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60ImportDefault</span><span class=mtk14>(</span><span class=mtk10>"${outDir}/../styles/styles.module.css"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>styles</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>CssModule </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span></code></pre><p>Let's say we're compiling with the <code>-o build</code> option and the file ends up in the <code>build/Components</code> directory. The generated code will look like:<pre class="atom-one-light grvsc-container"data-index=4 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>import</span><span class=mtk1> </span><span class=mtk5>styles</span><span class=mtk1> </span><span class=mtk14>from</span><span class=mtk1> </span><span class=mtk10>"../../styles/styles.module.css"</span></span></span></code></pre><h4 id=oop-class-definition-and-inheritance>OOP Class definition and inheritance<a href=#oop-class-definition-and-inheritance aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h4><p>Assuming we need to import a JS class, we can represent it in F# using a standard class declaration with an <code>Import</code> attribute. In this case we use <code>jsNative</code> as a dummy implementation for its members as the actual implementation will come from JS. When using <code>jsNative</code> don't forget to add the return type to the member!<pre class="atom-one-light grvsc-container"data-index=5 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60Import</span><span class=mtk14>(</span><span class=mtk10>"DataManager"</span><span class=mtk14>,</span><span class=mtk8> from</span><span class=mtk14>=</span><span class=mtk10>"library/data"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>DataManager</span><span class=mtk14>&lt;</span><span class=mtk4>'Model</span><span class=mtk14>></span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>conf</span><span class=mtk14>:</span><span class=mtk4> Config</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>_.delete</span><span class=mtk14>(</span><span class=mtk1>data</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>'Model</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>Promise</span><span class=mtk14>&lt;</span><span class=mtk4>'Model</span><span class=mtk14>></span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>_.insert</span><span class=mtk14>(</span><span class=mtk1>data</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>'Model</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>Promise</span><span class=mtk14>&lt;</span><span class=mtk4>'Model</span><span class=mtk14>></span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>_.update</span><span class=mtk14>(</span><span class=mtk1>data</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>'Model</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>Promise</span><span class=mtk14>&lt;</span><span class=mtk4>'Model</span><span class=mtk14>></span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span></code></pre><p>From this point it is possible to use it or even to inherit from it as it is usually done on regular F#, <a href=https://docs.microsoft.com/en-us/dotnet/fsharp/language-reference/inheritance>see the official F# documentation</a>. If you want to inherit and override a member, F# requires you to declare the member as <code>abstract</code> in the base class, with a default implementation if you want to make it also directly usable from the base class. For example:<pre class="atom-one-light grvsc-container"data-index=6 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// This class lives in JS</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60Import</span><span class=mtk14>(</span><span class=mtk10>"DataManager"</span><span class=mtk14>,</span><span class=mtk8> from</span><span class=mtk14>=</span><span class=mtk10>"library/data"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>DataManager</span><span class=mtk14>&lt;</span><span class=mtk4>'T</span><span class=mtk14>></span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>conf</span><span class=mtk14>:</span><span class=mtk4> Config</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>abstract</span><span class=mtk1> update</span><span class=mtk14>:</span><span class=mtk1> data</span><span class=mtk14>:</span><span class=mtk1> '</span><span class=mtk4>T</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>Promise</span><span class=mtk14>&lt;</span><span class=mtk4>'T</span><span class=mtk14>></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>default</span><span class=mtk1> </span><span class=mtk5>_.update</span><span class=mtk14>(</span><span class=mtk1>data</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>'T</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>Promise</span><span class=mtk14>&lt;</span><span class=mtk4>'T</span><span class=mtk14>></span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// This class lives in our code</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyDataManager</span><span class=mtk14>&lt;</span><span class=mtk4>'T</span><span class=mtk14>>(</span><span class=mtk1>config</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>inherit</span><span class=mtk1> DataManager</span><span class=mtk14>&lt;</span><span class=mtk1>'T</span><span class=mtk14>>(</span><span class=mtk1>config</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class="mtk7 mtki">// We can do something with data before sending it to the base class</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>override</span><span class=mtk1> </span><span class=mtk5>_.update</span><span class=mtk14>(</span><span class=mtk1>data</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        </span><span class=mtk14>base</span><span class=mtk1>.update</span><span class=mtk14>(</span><span class=mtk1>data</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>test</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>data</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>'T</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>manager</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>DataManager</span><span class=mtk14>&lt;</span><span class=mtk4>'T</span><span class=mtk14>>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    manager.update</span><span class=mtk14>(</span><span class=mtk1>data</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>|></span><span class=mtk1> ignore</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// This will call MyDataManager.update even if test expects DataManager</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>MyDataManager</span><span class=mtk14>(</span><span class=mtk1>myConfig</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>|></span><span class=mtk1> test myData</span></span></span></code></pre><article class="message is-info"><div class=message-body><div><p>If you have a Typescript declaration for the JS code you want to import, you can use <a href=https://github.com/fable-compiler/ts2fable>ts2fable</a> to help you write the F# bindings.</div></div></article><h4 id=lets-practice-1st-try>Let's practice! 1st try!<a href=#lets-practice-1st-try aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h4><p>Now that we've seen this, let's review the code in the <a href=https://github.com/fable-compiler/fable3-samples/tree/master/interop>interop</a> sample<p>Let's say we have an <code>alert.js</code> file that we'd like to use in our Fable project.<pre class="atom-one-light grvsc-container"data-index=7 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>function</span><span class=mtk1> </span><span class=mtk9>triggerAlert</span><span class=mtk1>(message) {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk9>alert</span><span class=mtk1>(message);</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>}</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>const</span><span class=mtk1> </span><span class=mtk6>someString</span><span class=mtk1> </span><span class=mtk8>=</span><span class=mtk1> </span><span class=mtk10>"And I Like that!"</span><span class=mtk1>;</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>export</span><span class=mtk1> { </span><span class=mtk5>triggerAlert</span><span class=mtk1>, </span><span class=mtk5>someString</span><span class=mtk1> };</span></span></span></code></pre><p>As you can see we've got one function, <code>triggerAlert</code> and one constant <code>someString</code>. Both are exported using the ES6 <code>export</code> keyword.<p>In order to use this in our Fable code, let's create an <code>interface</code> that will mimic this:<pre class="atom-one-light grvsc-container"data-index=8 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span><span class=mtk1> </span><span class="mtk7 mtki">// needed to call interop tools</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>IAlert</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>abstract</span><span class=mtk1> triggerAlert </span><span class=mtk14>:</span><span class=mtk1> message</span><span class=mtk14>:</span><span class=mtk4>string </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>unit</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>abstract</span><span class=mtk1> someString</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>string</span></span></span></code></pre><p>As you can see the process is quite easy. The <code>I</code> in <code>IAlert</code> is not mandatory but it's a precious hint that we're going to use an interface. The <code>abstract</code> keyword only indicates that there's no actual implementation in F#. That's true, since we rely on the JavaScript one.<p>Now let's use this:<pre class="atom-one-light grvsc-container"data-index=9 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk8>[&#60ImportAll</span><span class=mtk14>(</span><span class=mtk10>"path/to/alert.js"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>mylib</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>IAlert </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span></code></pre><p>Here we use the <code>ImportAll</code> attribute, which is the same as <code>Import("*", "path/to/alert.js")</code> just like we described earlier.<ul><li>step 1: We specify the elements we wish to use. Here <code>*</code> means: "take everything that's been exported"<li>step 2: we set the path to our js library.<li>step 3: we create a let binding called <code>mylib</code> to map the js library.<li>step 4: we use the <code>jsNative</code> keyword to say that <code>mylib</code> is just a placeholder for the JavaScript native implementation.</ul><p>Now we can use this:<pre class="atom-one-light grvsc-container"data-index=10 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>mylib.triggerAlert </span><span class=mtk14>(</span><span class=mtk10>"Hey I'm calling my js library from Fable > "</span><span class=mtk1> </span><span class=mtk14>+</span><span class=mtk1> mylib.someString</span><span class=mtk14>)</span></span></span></code></pre><p>If everything's working correctly, it should create an alert popup in your browser! Of course this sample is intended for web apps, but you could do the same in a Node.js app.<h4 id=lets-practice-2nd-try>Let's practice! 2nd try!<a href=#lets-practice-2nd-try aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h4><p>Assuming we've got two exported functions from a <code>Canvas.js</code> file: <code>drawSmiley</code> and <code>drawBubble</code>:<pre class="atom-one-light grvsc-container"data-index=11 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>export</span><span class=mtk1> </span><span class=mtk14>function</span><span class=mtk1> </span><span class=mtk9>drawSmiley</span><span class=mtk1>(id) {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class="mtk7 mtki">// do something</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>}</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>export</span><span class=mtk1> </span><span class=mtk14>function</span><span class=mtk1> </span><span class=mtk9>drawBubble</span><span class=mtk1>(id) {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class="mtk7 mtki">// do something</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>}</span></span></span></code></pre><p>we could use the same method we used with <code>alert.js</code>:<pre class="atom-one-light grvsc-container"data-index=12 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span><span class=mtk1> </span><span class="mtk7 mtki">// needed to call interop tools</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>ICanvas</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>abstract</span><span class=mtk1> drawSmiley</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>id</span><span class=mtk14>:</span><span class=mtk4>string</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>unit</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>abstract</span><span class=mtk1> drawBubble</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>id</span><span class=mtk14>:</span><span class=mtk4>string</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>unit</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk8>[&#60ImportAll</span><span class=mtk14>(</span><span class=mtk10>"path/to/Canvas.js"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>mylib</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>ICanvas </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  mylib.drawSmiley </span><span class=mtk10>"smiley"</span><span class=mtk1> </span><span class="mtk7 mtki">// etc..</span></span></span></code></pre><p>or we could use the <code>importMember</code> helper function to directly map the js function to the F# function.<pre class="atom-one-light grvsc-container"data-index=13 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span><span class=mtk1> </span><span class="mtk7 mtki">// needed to call interop tools</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>module</span><span class=mtk9> Canvas </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class="mtk7 mtki">// here we just import a member function from canvas.js called drawSmiley.</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>drawSmiley</span><span class=mtk14>(</span><span class=mtk1>id</span><span class=mtk14>:</span><span class=mtk4>string</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>unit </span><span class=mtk14>=</span><span class=mtk1> importMember </span><span class=mtk10>"path/to/Canvas.js"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>drawBubble</span><span class=mtk14>(</span><span class=mtk1>id</span><span class=mtk14>:</span><span class=mtk4>string</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>unit </span><span class=mtk14>=</span><span class=mtk1> importMember </span><span class=mtk10>"path/to/Canvas.js"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>Canvas.drawSmiley </span><span class=mtk10>"smiley"</span></span></span></code></pre><p>The result would be the same, but the philosophy is slightly different. That's basically up to you to make a choice ð<h4 id=miscellaneous-import-helpers>Miscellaneous import helpers<a href=#miscellaneous-import-helpers aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h4><p>There are other interop helpers you can use thanks to <code>Fable.Core.JsInterop</code>:<pre class="atom-one-light grvsc-container"data-index=14 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>buttons</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>obj </span><span class=mtk14>=</span><span class=mtk1> importAll </span><span class=mtk10>"my-lib/buttons"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// JS: import * as buttons from "my-lib/buttons"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// It works for function declarations too</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>getTheme</span><span class=mtk14>(</span><span class=mtk1>x</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>IInterface </span><span class=mtk14>=</span><span class=mtk1> importDefault </span><span class=mtk10>"my-lib"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// JS: import getTheme from "my-lib"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>myString</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>string </span><span class=mtk14>=</span><span class=mtk1> importMember </span><span class=mtk10>"my-lib"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// JS: import { myString } from "my-lib"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Use just `import` to make the member name explicit</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// as with the ImportAttribute</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>aDifferentName</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>string </span><span class=mtk14>=</span><span class=mtk1> import </span><span class=mtk10>"myString"</span><span class=mtk1> </span><span class=mtk10>"my-lib"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// import { myString } from "my-lib"</span></span></span></code></pre><p>Occasionally, you may need to import JS purely for its side-effects. For example, some browser polyfills don't export any functions, but extend the browser's built-in DOM types when executed.<p>For this, use <code>importSideEffects</code>.<pre class="atom-one-light grvsc-container"data-index=15 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>importSideEffects</span><span class=mtk14>(</span><span class=mtk10>"my-polyfill-library"</span><span class=mtk14>)</span><span class=mtk1> </span><span class="mtk7 mtki">// from npm package</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>importSideEffects</span><span class=mtk14>(</span><span class=mtk10>"./my-polyfill.js"</span><span class=mtk14>)</span><span class=mtk1> </span><span class="mtk7 mtki">// from local .js file</span></span></span></code></pre><h3 id=emit-when-f-is-not-enough>Emit, when F# is not enough<a href=#emit-when-f-is-not-enough aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h3><p>You can use the <code>Emit</code> attribute to decorate a function. Every call to the function will then be replaced inline by the content of the attribute with the placeholders <code>$0, $1, $2...</code> replaced by the arguments. For example, the following code will generate JavaScript as seen below.<pre class="atom-one-light grvsc-container"data-index=16 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60Emit</span><span class=mtk14>(</span><span class=mtk10>"$0 + $1"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>add</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>x</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>y</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>string</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>string </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>result</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> add </span><span class=mtk6>1</span><span class=mtk1> </span><span class=mtk10>"2"</span></span></span></code></pre><p>When you don't know the exact number of arguments you can use the following syntax:<pre class="atom-one-light grvsc-container"data-index=17 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>Test</span><span class=mtk6>()</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk8>[&#60Emit</span><span class=mtk14>(</span><span class=mtk10>"$0($1...)"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>__.Invoke</span><span class=mtk14>(</span><span class=mtk8>[&#60ParamArray>]</span><span class=mtk1> args</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>[]):</span><span class=mtk1> </span><span class=mtk4>obj </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span></code></pre><p>It's also possible to pass syntax conditioned to optional parameters:<pre class="atom-one-light grvsc-container"data-index=18 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>Test</span><span class=mtk6>()</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk8>[&#60Emit</span><span class=mtk14>(</span><span class=mtk10>"$0[$1]{{=$2}}"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>__.Item</span><span class=mtk1> </span><span class=mtk14>with</span><span class=mtk1> get</span><span class=mtk6>()</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>float </span><span class=mtk14>=</span><span class=mtk1> jsNative </span><span class=mtk14>and</span><span class=mtk1> set</span><span class=mtk14>(</span><span class=mtk1>v</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>float</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>unit </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class="mtk7 mtki">// This syntax means: if second arg evals to true in JS print 'i' and nothing otherwise</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk8>[&#60Emit</span><span class=mtk14>(</span><span class=mtk10>"new RegExp($0,'g{{$1?i:}}')"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>__.ParseRegex</span><span class=mtk14>(</span><span class=mtk1>pattern</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>string</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk14>?</span><span class=mtk1>ignoreCase</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>bool</span><span class=mtk14>):</span><span class=mtk1> </span><span class=mtk4>Regex </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span></code></pre><p>The content of <code>Emit</code> will actually be parsed by <a href=https://babeljs.io/>Babel</a> so it will still be validated somehow. However, it's not advised to abuse this method, as the code won't be checked by the F# compiler.<h4 id=lets-do-it-use-emit>Let's do it! Use Emit<a href=#lets-do-it-use-emit aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h4><p>Now let's work with Emit and look at a new example with the following <code>MyClass.js</code>:<pre class="atom-one-light grvsc-container"data-index=19 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>export</span><span class=mtk1> </span><span class=mtk5>default</span><span class=mtk1> </span><span class=mtk14>class</span><span class=mtk1> </span><span class=mtk4>MyClass</span><span class=mtk1> {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class="mtk7 mtki">// Note the constructor accepts an object</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class="mtk7 mtki">// with the `value` and `awesomeness` fields</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>constructor</span><span class=mtk1>({ value, awesomeness }) {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk5>this</span><span class=mtk1>.</span><span class=mtk5>_value</span><span class=mtk1> </span><span class=mtk8>=</span><span class=mtk1> </span><span class=mtk5>value</span><span class=mtk1>;</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk5>this</span><span class=mtk1>.</span><span class=mtk5>_awesomeness</span><span class=mtk1> </span><span class=mtk8>=</span><span class=mtk1> </span><span class=mtk5>awesomeness</span><span class=mtk1>;</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  }</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk8>get</span><span class=mtk1> </span><span class=mtk9>value</span><span class=mtk1>() {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>return</span><span class=mtk1> </span><span class=mtk5>this</span><span class=mtk1>.</span><span class=mtk5>_value</span><span class=mtk1>;</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  }</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk8>set</span><span class=mtk1> </span><span class=mtk9>value</span><span class=mtk1>( newValue ) {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk5>this</span><span class=mtk1>.</span><span class=mtk5>_value</span><span class=mtk1> </span><span class=mtk8>=</span><span class=mtk1> </span><span class=mtk5>newValue</span><span class=mtk1>;</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  }</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk9>isAwesome</span><span class=mtk1>() {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>return</span><span class=mtk1> </span><span class=mtk5>this</span><span class=mtk1>.</span><span class=mtk5>_value</span><span class=mtk1> </span><span class=mtk8>===</span><span class=mtk1> </span><span class=mtk5>this</span><span class=mtk1>.</span><span class=mtk5>_awesomeness</span><span class=mtk1>;</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  }</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>static</span><span class=mtk1> </span><span class=mtk9>getPI</span><span class=mtk1>() {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>return</span><span class=mtk1> </span><span class=mtk6>Math</span><span class=mtk1>.</span><span class=mtk6>PI</span><span class=mtk1>;</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  }</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>}</span></span></span></code></pre><p>Let's list its members:<ul><li>a <code>value</code> member which returns the current value with a getter and a setter<li>a method, <code>isAwesome</code>, that checks if the current value equals the awesome value<li>a static method <code>getPi()</code> that just returns the value of <code>Math.PI</code></ul><p>Here's the Fable implementation. Let's start with the members:<pre class="atom-one-light grvsc-container"data-index=20 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyClass</span><span class=mtk14>&lt;</span><span class=mtk4>'T</span><span class=mtk14>></span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class="mtk7 mtki">// Note we specify this property has also a setter</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>abstract</span><span class=mtk1> value</span><span class=mtk14>:</span><span class=mtk1> '</span><span class=mtk4>T</span><span class=mtk1> </span><span class=mtk14>with</span><span class=mtk1> get</span><span class=mtk14>,</span><span class=mtk1> set</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>abstract</span><span class=mtk1> isAwesome</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>unit</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>bool</span></span></span></code></pre><p>Now we need to be able to call the static functions, including the constructor. So we write another interface for that:<pre class="atom-one-light grvsc-container"data-index=21 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyClassStatic</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk8>[&#60Emit</span><span class=mtk14>(</span><span class=mtk10>"new $0({ value: $1, awesomeness: $2 })"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>abstract</span><span class=mtk1> Create</span><span class=mtk14>:</span><span class=mtk1> '</span><span class=mtk4>T</span><span class=mtk1> </span><span class=mtk14>*</span><span class=mtk1> '</span><span class=mtk4>T</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>MyClass</span><span class=mtk14>&lt;</span><span class=mtk4>'T</span><span class=mtk14>></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>abstract</span><span class=mtk1> getPI </span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>unit</span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>float</span></span></span></code></pre><article class="message is-info"><div class=message-body><div><p>We could have used a class declaration with dummy implementations as we did with DataManager above, but you will find that in Fable bindings it's common to split the instance and static parts of a JS type in two interfaces to overcome some restrictions of the F# type system or to be able to deal with JS classes as values. In this case, by convention <code>Create</code> denotes the constructor.</div></div></article><p>Here we used the <code>Emit</code> attribute to apply the JS <code>new</code> keyword and to build a JS object with the arguments, because that's what MyClass constructor accepts. Note that here <code>$0</code> represents the interface object (in this case, MyClass static).<p>Last but not least, let's import MyClass:<pre class="atom-one-light grvsc-container"data-index=22 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60ImportDefault</span><span class=mtk14>(</span><span class=mtk10>"../public/MyClass.js"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>MyClass</span><span class=mtk1> </span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>MyClassStatic </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span></code></pre><p>Now it's possible to use our JS class. Let's see the complete code:<pre class="atom-one-light grvsc-container"data-index=23 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyClass</span><span class=mtk14>&lt;</span><span class=mtk4>'T</span><span class=mtk14>></span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>abstract</span><span class=mtk1> value</span><span class=mtk14>:</span><span class=mtk1> '</span><span class=mtk4>T</span><span class=mtk1> </span><span class=mtk14>with</span><span class=mtk1> get</span><span class=mtk14>,</span><span class=mtk1> set</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>abstract</span><span class=mtk1> isAwesome</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>unit</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>bool</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyClassStatic</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk8>[&#60Emit</span><span class=mtk14>(</span><span class=mtk10>"new $0({ value: $1, awesomeness: $2 })"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>abstract</span><span class=mtk1> Create</span><span class=mtk14>:</span><span class=mtk1> '</span><span class=mtk4>T</span><span class=mtk1> </span><span class=mtk14>*</span><span class=mtk1> '</span><span class=mtk4>T</span><span class=mtk1> </span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>MyClass</span><span class=mtk14>&lt;</span><span class=mtk4>'T</span><span class=mtk14>></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>  </span><span class=mtk14>abstract</span><span class=mtk1> getPI </span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>unit</span><span class=mtk14>-></span><span class=mtk1> </span><span class=mtk4>float</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60ImportDefault</span><span class=mtk14>(</span><span class=mtk10>"../public/MyClass.js"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>MyClass</span><span class=mtk1> </span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>MyClassStatic </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>myObject</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> MyClass.Create</span><span class=mtk14>(</span><span class=mtk6>40</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk6>42</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// using getter</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>whatDoIget</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> myObject.value </span><span class="mtk7 mtki">// using getter</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>mylib.triggerAlert </span><span class=mtk14>(</span><span class=mtk10>"Hey I'm calling my js class from Fable. It gives "</span><span class=mtk1> </span><span class=mtk14>+</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>string whatDoIget</span><span class=mtk14>))</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// using setter</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myObject.value </span><span class=mtk14>&#60-</span><span class=mtk1> </span><span class=mtk6>42</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>mylib.triggerAlert </span><span class=mtk14>(</span><span class=mtk10>"Now it's better. It gives "</span><span class=mtk1> </span><span class=mtk14>+</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>string myObject.value</span><span class=mtk14>))</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// calling member function</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>mylib.triggerAlert </span><span class=mtk14>(</span><span class=mtk10>"Isn't it awesome? "</span><span class=mtk1> </span><span class=mtk14>+</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>string </span><span class=mtk14>(</span><span class=mtk1>myObject.isAwesome</span><span class=mtk14>())))</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// call our static function</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>mylib.triggerAlert </span><span class=mtk14>(</span><span class=mtk10>"PI is "</span><span class=mtk1> </span><span class=mtk14>+</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>string </span><span class=mtk14>(</span><span class=mtk1>MyClass.getPI</span><span class=mtk14>())))</span></span></span></code></pre><p>It's possible to combine the <code>Import</code> and <code>Emit</code> attributes. So we can import and build MyClass in one go. Note that in this case <code>$0</code> is replaced by the imported element:<pre class="atom-one-light grvsc-container"data-index=24 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60ImportDefault</span><span class=mtk14>(</span><span class=mtk10>"../public/MyClass.js"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60Emit</span><span class=mtk14>(</span><span class=mtk10>"new $0({ value: $1, awesomeness: $2 })"</span><span class=mtk14>)</span><span class=mtk8>>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>createMyClass</span><span class=mtk14>(</span><span class=mtk1>value</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>'T</span><span class=mtk14>,</span><span class=mtk1> awesomeness</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>'T</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>MyClass</span><span class=mtk14>&lt;</span><span class=mtk4>'T</span><span class=mtk14>></span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> jsNative</span></span></span></code></pre><h3 id=other-special-attributes>Other special attributes<a href=#other-special-attributes aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h3><p><code>Fable.Core</code> includes other attributes for JS interop, like:<h4 id=erase-attribute>Erase attribute<a href=#erase-attribute aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h4><p>In TypeScript there's a concept of <a href=https://www.typescriptlang.org/docs/handbook/advanced-types.html#union-types>Union Types</a> which differs from union types in F#. The former are just used to statically check a function argument accepting different types. In Fable, they're translated as <strong>Erased Union Types</strong> whose cases must have one and only one single data field. After compilation, the wrapping will be erased and only the data field will remain. To define an erased union type, just attach the <code>Erase</code> attribute to the type. Example:<pre class="atom-one-light grvsc-container"data-index=25 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60Erase>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyErasedType</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> String </span><span class=mtk14>of</span><span class=mtk1> </span><span class=mtk4>string</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> Number </span><span class=mtk14>of</span><span class=mtk1> </span><span class=mtk4>int</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myLib.myMethod</span><span class=mtk14>(</span><span class=mtk1>String </span><span class=mtk10>"test"</span><span class=mtk14>)</span></span></span></code></pre><pre class="atom-one-light grvsc-container"data-index=26 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk1>myLib.</span><span class=mtk9>myMethod</span><span class=mtk1>(</span><span class=mtk10>"test"</span><span class=mtk1>)</span></span></span></code></pre><p><code>Fable.Core</code> already includes predefined erased types which can be used as follows:<pre class="atom-one-light grvsc-container"data-index=27 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>Test</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk14>abstract</span><span class=mtk1> Value</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>string</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>myMethod</span><span class=mtk14>(</span><span class=mtk1>arg</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>U3</span><span class=mtk14>&lt;</span><span class=mtk4>string</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk4>Test</span><span class=mtk14>>):</span><span class=mtk1> </span><span class=mtk4>unit </span><span class=mtk14>=</span><span class=mtk1> importMember </span><span class=mtk10>"./myJsLib"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>testValue</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk14>{</span><span class=mtk1> </span><span class=mtk14>new</span><span class=mtk1> Test </span><span class=mtk14>with</span><span class=mtk1> </span><span class=mtk14>member</span><span class=mtk1> </span><span class=mtk5>__.Value</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk10>"Test"</span><span class=mtk1> </span><span class=mtk14>}</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myMethod</span><span class=mtk14>(</span><span class=mtk1>U3.Case3 testValue</span><span class=mtk14>)</span></span></span></code></pre><p>When passing arguments to a method accepting <code>U2</code>, <code>U3</code>... you can use the <code>!^</code> as syntax sugar so you don't need to type the exact case (the argument will still be type checked):<pre class="atom-one-light grvsc-container"data-index=28 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myMethod </span><span class=mtk14>!^</span><span class=mtk6>5</span><span class=mtk1> </span><span class="mtk7 mtki">// Equivalent to: myMethod(U3.Case2 5)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myMethod </span><span class=mtk14>!^</span><span class=mtk1>testValue</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// This doesn't compile, myMethod doesn't accept floats</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myMethod </span><span class=mtk14>!^</span><span class=mtk6>2.3</span></span></span></code></pre><article class="message is-info"><div class=message-body><div><p>Please note erased unions are mainly intended for typing the signature of imported JS functions and not as a cheap replacement of <code>Choice</code>. It's possible to do pattern matching against an erased union type but this will be compiled as type testing, and since <strong>type testing is very weak in Fable</strong>, this is only recommended if the generic arguments of the erased union are types that can be easily told apart in the JS runtime (like a string, a number and an array).</div></div></article><pre class="atom-one-light grvsc-container"data-index=29 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>test</span><span class=mtk14>(</span><span class=mtk1>arg</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>U3</span><span class=mtk14>&lt;</span><span class=mtk4>string</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk4>float</span><span class=mtk14>[]>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>match</span><span class=mtk1> arg </span><span class=mtk14>with</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> U3.Case1 x </span><span class=mtk14>-></span><span class=mtk1> printfn </span><span class=mtk10>"A string </span><span class=mtk14>%s</span><span class=mtk10>"</span><span class=mtk1> x</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> U3.Case2 x </span><span class=mtk14>-></span><span class=mtk1> printfn </span><span class=mtk10>"An int </span><span class=mtk14>%i</span><span class=mtk10>"</span><span class=mtk1> x</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> U3.Case3 xs </span><span class=mtk14>-></span><span class=mtk1> Array.sum xs </span><span class=mtk14>|></span><span class=mtk1> printfn </span><span class=mtk10>"An array with sum </span><span class=mtk14>%f</span><span class=mtk10>"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// In JS roughly translated as:</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// function test(arg) {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//   if (typeof arg === "number") {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//     toConsole(printf("An int %i"))(arg);</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//   } else if (isArray(arg)) {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//     toConsole(printf("An array with sum %f"))(sum(arg));</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//   } else {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//     toConsole(printf("A string %s"))(arg);</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//   }</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// }</span></span></span></code></pre><h4 id=stringenum>StringEnum<a href=#stringenum aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h4><p>In TypeScript it is possible to define <a href=https://mariusschulz.com/blog/string-literal-types-in-typescript>String Literal Types</a> which are similar to enumerations with an underlying string value. Fable allows the same feature by using union types and the <code>StringEnum</code> attribute. These union types must not have any data fields as they will be compiled to a string matching the name of the union case.<p>By default, the compiled string will have the first letter lowered. If you want to prevent this or use a different text than the union case name, use the <code>CompiledName</code> attribute:<pre class="atom-one-light grvsc-container"data-index=30 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk8>[&#60StringEnum>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>MyStrings</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> Vertical</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> </span><span class=mtk8>[&#60CompiledName</span><span class=mtk14>(</span><span class=mtk10>"Horizontal"</span><span class=mtk14>)</span><span class=mtk8>>]</span><span class=mtk1> Horizontal</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myLib.myMethod</span><span class=mtk14>(</span><span class=mtk1>Vertical</span><span class=mtk14>,</span><span class=mtk1> Horizontal</span><span class=mtk14>)</span></span></span></code></pre><pre class="atom-one-light grvsc-container"data-index=31 data-language=js><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// js output</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>myLib.</span><span class=mtk9>myMethod</span><span class=mtk1>(</span><span class=mtk10>"vertical"</span><span class=mtk1>, </span><span class=mtk10>"Horizontal"</span><span class=mtk1>)</span></span></span></code></pre><h3 id=plain-old-javascript-objects>Plain Old JavaScript Objects<a href=#plain-old-javascript-objects aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h3><p>To create a plain JS object (aka POJO), use <code>createObj</code>:<pre class="atom-one-light grvsc-container"data-index=32 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>data</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    createObj </span><span class=mtk14>[</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        </span><span class=mtk10>"todos"</span><span class=mtk1> </span><span class=mtk14>==></span><span class=mtk1> Storage.fetch</span><span class=mtk6>()</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        </span><span class=mtk10>"editedTodo"</span><span class=mtk1> </span><span class=mtk14>==></span><span class=mtk1> Option</span><span class=mtk14>&lt;</span><span class=mtk1>Todo</span><span class=mtk14>></span><span class=mtk1>.None</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        </span><span class=mtk10>"visibility"</span><span class=mtk1> </span><span class=mtk14>==></span><span class=mtk1> </span><span class=mtk10>"all"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>]</span></span></span></code></pre><p>A similar effect can be achieved with the new F# <a href=https://devblogs.microsoft.com/dotnet/announcing-f-4-6-preview/>anonymous records</a>:<pre class="atom-one-light grvsc-container"data-index=33 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>data</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>{|</span><span class=mtk1> todos </span><span class=mtk14>=</span><span class=mtk1> Storage.fetch</span><span class=mtk6>()</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>       editedTodo </span><span class=mtk14>=</span><span class=mtk1> Option</span><span class=mtk14>&lt;</span><span class=mtk1>Todo</span><span class=mtk14>></span><span class=mtk1>.None</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>       visibility </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk10>"all"</span><span class=mtk1> </span><span class=mtk14>|}</span></span></span></code></pre><article class="message is-info"><div class=message-body><div><p>Since fable-compiler 2.3.6, when using the dynamic cast operator <code>!!</code> to cast an anonymous record to an interface, Fable will raise a warning if the fields in the anonymous don't match those of the interface. Use this feature only to interop with JS, in F# code the proper way to instantiate an interface without an implementing type is an <a href=https://fsharpforfunandprofit.com/posts/object-expressions/>object expression</a>.</div></div></article><pre class="atom-one-light grvsc-container"data-index=34 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>IMyInterface</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>abstract</span><span class=mtk1> foo</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>string</span><span class=mtk1> </span><span class=mtk14>with</span><span class=mtk1> get</span><span class=mtk14>,</span><span class=mtk1> set</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>abstract</span><span class=mtk1> bar</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>float</span><span class=mtk1> </span><span class=mtk14>with</span><span class=mtk1> get</span><span class=mtk14>,</span><span class=mtk1> set</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>abstract</span><span class=mtk1> baz</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>int</span><span class=mtk1> </span><span class=mtk4>option</span><span class=mtk1> </span><span class=mtk14>with</span><span class=mtk1> get</span><span class=mtk14>,</span><span class=mtk1> set</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Warning, "foo" must be a string</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>x</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>IMyInterface </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk14>!!{|</span><span class=mtk1> foo </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk6>5</span><span class=mtk14>;</span><span class=mtk1> bar </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk6>4.</span><span class=mtk14>;</span><span class=mtk1> baz </span><span class=mtk14>=</span><span class=mtk1> Some </span><span class=mtk6>0</span><span class=mtk1> </span><span class=mtk14>|}</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Warning, "bar" field is missing</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>y</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>IMyInterface </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk14>!!{|</span><span class=mtk1> foo </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk10>"5"</span><span class=mtk14>;</span><span class=mtk1> bAr </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk6>4.</span><span class=mtk14>;</span><span class=mtk1> baz </span><span class=mtk14>=</span><span class=mtk1> Some </span><span class=mtk6>0</span><span class=mtk1> </span><span class=mtk14>|}</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// Ok, "baz" can be missing because it's optional</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>z</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>IMyInterface </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk14>!!{|</span><span class=mtk1> foo </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk10>"5"</span><span class=mtk14>;</span><span class=mtk1> bar </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk6>4.</span><span class=mtk1> </span><span class=mtk14>|}</span></span></span></code></pre><p>You can also create a JS object from an interface by using <code>createEmpty</code> and then assigning the fields manually:<pre class="atom-one-light grvsc-container"data-index=35 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>x</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> createEmpty</span><span class=mtk14>&lt;</span><span class=mtk1>IMyInterface</span><span class=mtk14>></span><span class=mtk1> </span><span class="mtk7 mtki">// var x = {}</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>x.foo </span><span class=mtk14>&#60-</span><span class=mtk1> </span><span class=mtk10>"abc"</span><span class=mtk1>                    </span><span class="mtk7 mtki">// x.foo = "abc"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>x.bar </span><span class=mtk14>&#60-</span><span class=mtk1> </span><span class=mtk6>8.5</span><span class=mtk1>                      </span><span class="mtk7 mtki">// val.bar = 8.5</span></span></span></code></pre><p>A similar solution that can also be optimized by Fable directly into a JS object at compile time is to use the <code>jsOptions</code> helper:<pre class="atom-one-light grvsc-container"data-index=36 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>x</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> jsOptions</span><span class=mtk14>&lt;</span><span class=mtk1>IMyInterface</span><span class=mtk14>>(fun</span><span class=mtk1> x </span><span class=mtk14>-></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    x.foo </span><span class=mtk14>&#60-</span><span class=mtk1> </span><span class=mtk10>"abc"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    x.bar </span><span class=mtk14>&#60-</span><span class=mtk1> </span><span class=mtk6>8.5</span><span class=mtk14>)</span></span></span></code></pre><p>Another option is to use a list (or any sequence) of union cases in combination with the <code>keyValueList</code> helper. This is often used to represent React props. You can specify the case rules for the transformations of the case names (usually lowering the first letter) and if necessary you can also decorate some cases with the <code>CompiledName</code> attribute to change its name in the JS runtime.<pre class="atom-one-light grvsc-container"data-index=37 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>type</span><span class=mtk1> </span><span class=mtk4>JsOption</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> Flag1</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> Name </span><span class=mtk14>of</span><span class=mtk1> </span><span class=mtk4>string</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    </span><span class=mtk14>|</span><span class=mtk1> </span><span class=mtk8>[&#60CompiledName</span><span class=mtk14>(</span><span class=mtk10>"quantity"</span><span class=mtk14>)</span><span class=mtk8>>]</span><span class=mtk1> QTY </span><span class=mtk14>of</span><span class=mtk1> </span><span class=mtk4>int</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let inline</span><span class=mtk1> </span><span class=mtk5>sendToJs</span><span class=mtk1> </span><span class=mtk14>(</span><span class=mtk1>opts</span><span class=mtk14>:</span><span class=mtk1> </span><span class=mtk4>JsOption list</span><span class=mtk14>)</span><span class=mtk1> </span><span class=mtk14>=</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    keyValueList CaseRules.LowerFirst opts </span><span class=mtk14>|></span><span class=mtk1> aNativeJsFunction</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>sendToJs </span><span class=mtk14>[</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    Flag1</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    Name </span><span class=mtk10>"foo"</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    QTY </span><span class=mtk6>5</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>]</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// JS: { flag1: true, name: "foo", quantity: 5 }</span></span></span></code></pre><article class="message is-info"><div class=message-body><div><p>Fable can make the transformation at compile time when applying the list literal directly to <code>keyValueList</code>. That's why it's usually a good idea to inline the function containing the helper.</div></div></article><h3 id=dynamic-typing-dont-read-this>Dynamic typing: don't read this!<a href=#dynamic-typing-dont-read-this aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h3><p>Through the use of the tools we just described above, Fable guarantees you shouldn't run into nasty bugs (as long as the interface contracts are correct) because all the code will be checked by the compiler. If it does not compile it either means your JS library does not exist or its path is not good or that your F# implementation lacks something. We do rely on Fable on systems that are used 24/7, web apps or Node.js apps. We know that if it compiles, it means a 99% chance of running without any problems.<p>Our motto is: "If it compiles, it works!"<p>Still, like we stated, <strong>interop is a question of trust</strong>. If you trust your JS code and F# code, then maybe it's ok to do things together without further checks. Maybe.<article class="message is-warning"><div class=message-body><div><p>Disclaimer: use this at your own risk</div></div></article><h4 id=what-is-dynamic-typing>What is dynamic typing?<a href=#what-is-dynamic-typing aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h4><p>Fable.Core.JsInterop implements the F# dynamic operators so you can easily access an object property by name (without static check) as follows:<pre class="atom-one-light grvsc-container"data-index=38 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>printfn </span><span class=mtk10>"Value: </span><span class=mtk14>%O</span><span class=mtk10>"</span><span class=mtk1> jsObject?myProperty</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// JS: jsObject?myProperty</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>pname</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> </span><span class=mtk10>"myProperty"</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>printfn </span><span class=mtk10>"Value: </span><span class=mtk14>%O</span><span class=mtk10>"</span><span class=mtk1> jsObject?</span><span class=mtk14>(</span><span class=mtk1>pname</span><span class=mtk14>)</span><span class=mtk1> </span><span class="mtk7 mtki">// Access with a reference</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// JS: jsObject[pname]</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>jsObject?myProperty </span><span class=mtk14>&#60-</span><span class=mtk1> </span><span class=mtk6>5</span><span class=mtk1> </span><span class="mtk7 mtki">// Assignment is also possible</span></span></span></code></pre><p>When you combine the dynamic operator with application, Fable will destructure tuple arguments as with normal method calls. These operations can also be chained to replicate JS fluent APIs.<pre class="atom-one-light grvsc-container"data-index=39 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>result</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> jsObject?myMethod</span><span class=mtk14>(</span><span class=mtk6>1</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk6>2</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// JS: jsObject.myMethod(1, 2)</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>chart</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    ?width</span><span class=mtk14>(</span><span class=mtk6>768.</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    ?height</span><span class=mtk14>(</span><span class=mtk6>480.</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    ?group</span><span class=mtk14>(</span><span class=mtk1>speedSumGroup</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>    ?on</span><span class=mtk14>(</span><span class=mtk10>"renderlet"</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk14>fun</span><span class=mtk1> chart </span><span class=mtk14>-></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>        chart?selectAll</span><span class=mtk14>(</span><span class=mtk10>"rect"</span><span class=mtk14>)</span><span class=mtk1>?on</span><span class=mtk14>(</span><span class=mtk10>"click"</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk14>fun</span><span class=mtk1> sender args </span><span class=mtk14>-></span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>            Browser.console.log</span><span class=mtk14>(</span><span class=mtk10>"click!"</span><span class=mtk14>,</span><span class=mtk1> args</span><span class=mtk14>))</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// chart</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//     .width(768)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//     .height(480)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//     .group(speedSumGroup)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//     .on("renderlet", function (chart) {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//         return chart.selectAll("rect").on("click", function (sender, args) {</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//             return console.log("click!", args);</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//         });</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">//      });</span></span></span></code></pre><p>When you have to call a function with the new keyword in JS, use <code>createNew</code>.<pre class="atom-one-light grvsc-container"data-index=40 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.JsInterop</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>instance</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> createNew jsObject</span><span class=mtk14>(</span><span class=mtk6>1</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk6>2</span><span class=mtk14>)</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class="mtk7 mtki">// JS: new jsObject(1, 2)</span></span></span></code></pre><p>If you prefer member extensions rather than operators for dynamic typing, you can open <code>Fable.Core.DynamicExtensions</code> to have the methods <code>.Item</code> and <code>.Invoke</code> available on any object.<pre class="atom-one-light grvsc-container"data-index=41 data-language=fsharp><code class=grvsc-code><span class=grvsc-line><span class=grvsc-source><span class=mtk14>open</span><span class=mtk1> </span><span class=mtk9>Fable.Core.DynamicExtensions</span></span></span>
<span class=grvsc-line><span class=grvsc-source></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>foo</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> obj</span><span class=mtk6>()</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>bar1</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> foo.</span><span class=mtk14>[</span><span class=mtk10>"b"</span><span class=mtk14>]</span><span class=mtk1>  </span><span class="mtk7 mtki">// Same as foo.Item("b")</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk1>foo.</span><span class=mtk14>[</span><span class=mtk10>"c"</span><span class=mtk14>]</span><span class=mtk1> </span><span class=mtk14>&#60-</span><span class=mtk1> </span><span class=mtk6>14</span></span></span>
<span class=grvsc-line><span class=grvsc-source><span class=mtk14>let</span><span class=mtk1> </span><span class=mtk5>bar2</span><span class=mtk1> </span><span class=mtk14>=</span><span class=mtk1> foo.Invoke</span><span class=mtk14>(</span><span class=mtk6>4</span><span class=mtk14>,</span><span class=mtk1> </span><span class=mtk10>"a"</span><span class=mtk14>)</span></span></span></code></pre><h4 id=dynamic-casting>Dynamic casting<a href=#dynamic-casting aria-hidden=true tabindex=-1><span class=[anchor]></span>#</a></h4><p>In some situations, when receiving an untyped object from JS you may want to cast it to a specific type. For this you can use the F# <code>unbox</code> function or the <code>!!</code> operator in Fable.Core.JsInterop. This will bypass the F# type checker but please note <strong>Fable will not add any runtime check</strong> to verify the cast is correct.</div></div></section><div class="section bd-docs-pagination bd-pagination-links"><a class="button bd-fat-button is-primary is-light bd-pagination-prev" href="/docs/your-fable-project/testing.html"><i>â</i><span class="is-hidden-mobile"><em>Your Fable project</em><strong>Testing</strong></span></a><a class="button bd-fat-button is-primary is-light bd-pagination-next" href="/docs/communicate/fable-from-js.html"><span class="is-hidden-mobile"><em>Communicate with Javascript</em><strong>Call Fable from JavaScript</strong></span><i>â</i></a></div></div></div></div></div><script async="" src="/resources/nacara-standard-layouts/scripts/menu.js"></script></body></html>