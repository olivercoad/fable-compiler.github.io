<html class="has-navbar-fixed-top" lang="en"><head><title>Fable · Introducing Fable 2.0 beta</title><meta http-equiv="content-type" content="text/html; charset=UTF-8" charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" type="text/css" href="/style.css"/><script src="https://unpkg.com/scroll-into-view-if-needed@2.2.28/umd/scroll-into-view-if-needed.min.js"></script></head><body><nav class="navbar is-fixed-top is-spaced"><div class="container"><div class="navbar-brand"><a class="navbar-item title is-4" href="https://fable.io/">Fable</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/docs">Documentation</a><a class="navbar-item is-hidden-mobile" href="/repl/">Try</a><a class="navbar-item is-active" href="/blog/index.html">Blog</a><a class="navbar-item is-hidden-mobile" href="/community.html">Community</a><a class="navbar-item is-hidden-mobile" href="/resources.html">Resources</a><div class="navbar-item navbar-burger-dots is-hidden-tablet"><svg height="4" stroke="none" viewBox="0 0 22 4" width="22"><circle cx="2" cy="2" r="2"></circle><circle cx="2" cy="2" r="2" transform="translate(9,0)"></circle><circle cx="2" cy="2" r="2" transform="translate(18,0)"></circle></svg></div></div><div class="navbar-end is-hidden-mobile"><a class="navbar-item" href="https://github.com/fable-compiler/fable"><span class="icon"><i class=" fab fa-github fa-lg"></i></span></a><a class="navbar-item" href="https://twitter.com/FableCompiler"><span class="icon"><i class=" fab fa-twitter fa-lg"></i></span></a><a class="navbar-item" href="https://gitter.im/fable-compiler/Fable"><span class="icon"><i class=" fab fa-gitter fa-lg"></i></span></a><a class="navbar-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos"><span class="icon"><i class=" fab fa-youtube fa-lg"></i></span></a></div></div><div class="nacara-navbar-menu"><a class="nacara-navbar-menu-item" href="/repl/">Try</a><a class="nacara-navbar-menu-item" href="/community.html">Community</a><a class="nacara-navbar-menu-item" href="/resources.html">Resources</a><a class="nacara-navbar-menu-item" href="https://github.com/fable-compiler/fable">Github</a><a class="nacara-navbar-menu-item" href="https://twitter.com/FableCompiler">Twitter</a><a class="nacara-navbar-menu-item" href="https://gitter.im/fable-compiler/Fable">Gitter</a><a class="nacara-navbar-menu-item" href="https://www.youtube.com/channel/UC6m70Jyr65ogDySbK7aMmzg/videos">Youtube</a></div></div></nav><div class="grey-overlay"></div><div class="nacara-content"><div class="container"><div class="columns"><div class="column is-8-desktop is-offset-2-desktop"><div class="section blog-post"><figure class="image is-96x96 author-image"><img class="is-rounded" src="https://github.com/alfonsogarciacaro.png"/></figure><h2 class="title is-size-3 has-text-primary has-text-weight-normal has-text-centered blog-title">Introducing Fable 2.0 beta</h2><div class="tags has-addons is-justify-content-center"><a class="tag is-rounded is-medium is-primary" href="https://twitter.com/alfonsogcnunez">Alfonso García-Caro</a><span class="tag is-rounded is-medium">August 3, 2018</span></div><div class="content"><style class=grvsc-styles>.grvsc-container{overflow:auto;position:relative;-webkit-overflow-scrolling:touch;padding-top:1rem;padding-top:var(--grvsc-padding-top,var(--grvsc-padding-v,1rem));padding-bottom:1rem;padding-bottom:var(--grvsc-padding-bottom,var(--grvsc-padding-v,1rem));border-radius:8px;border-radius:var(--grvsc-border-radius,8px);font-feature-settings:normal;line-height:1.4}.grvsc-code{display:table}.grvsc-line{display:table-row;box-sizing:border-box;width:100%;position:relative}.grvsc-line>*{position:relative}.grvsc-gutter-pad{display:table-cell;padding-left:.75rem;padding-left:calc(var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem))/ 2)}.grvsc-gutter{display:table-cell;-webkit-user-select:none;-moz-user-select:none;user-select:none}.grvsc-gutter::before{content:attr(data-content)}.grvsc-source{display:table-cell;padding-left:1.5rem;padding-left:var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem));padding-right:1.5rem;padding-right:var(--grvsc-padding-right,var(--grvsc-padding-h,1.5rem))}.grvsc-source:empty::after{content:' ';-webkit-user-select:none;-moz-user-select:none;user-select:none}.grvsc-gutter+.grvsc-source{padding-left:.75rem;padding-left:calc(var(--grvsc-padding-left,var(--grvsc-padding-h,1.5rem))/ 2)}.grvsc-has-line-highlighting>.grvsc-code>.grvsc-line::before{content:' ';position:absolute;width:100%}.grvsc-line-diff-add::before{background-color:var(--grvsc-line-diff-add-background-color,rgba(0,255,60,.2))}.grvsc-line-diff-del::before{background-color:var(--grvsc-line-diff-del-background-color,rgba(255,0,20,.2))}.grvsc-line-number{padding:0 2px;text-align:right;opacity:.7}</style><h2>TL;DR</h2><ul><li><strong>Fable 2? Really? I want to try it out! NOW!</strong> The easiest way is to check <a href=http://fable.io/repl>the new and shiny repl</a> for quickly running and editing samples online. To test the new tooling in your machine, we have prepared two samples: <a href=https://github.com/fable-compiler/fable2-samples/tree/master/minimal>one with minimal configuration</a> if you prefer to start with the basics; and <a href=https://github.com/MangelMaxime/fulma-demo>a full-blown app</a> that includes most extensive configuration and code.</ul><blockquote><p>Note <a href=http://fable.io/repl-legacy>the old repl</a> is still alive in case you want to compare the different outputs.</blockquote><ul><li><p><strong>Is Fable 2 any better?</strong> Two is bigger than one, <a href="https://www.youtube.com/watch?v=uMSV4OteqBE&#38feature=youtu.be&#38t=80">so it has to be!</a> Jokes aside, there's still room for improvement and we haven't done extensive benchmarking yet, but early findings show you can get <a href=https://github.com/MangelMaxime/fulma-demo/pull/5#issue-190709436>between 30-40% bundle size reduction</a> as well as <a href=https://github.com/fable-compiler/Fable/issues/1457#issuecomment-406901930>up to 2x speed boost</a> in complex computing-intensive apps (like Fable REPL itself).<li><p><strong>Are there breaking changes?</strong> We've tried to reduce them as much as possible but there are a few, particularly in JSON serialization. See below.<li><p><strong>Is this ready for production?</strong> No! Yes! Maybe. I don't know. It's basically passing all the tests from Fable 1 and a few more. Some of us are already using it in production, but obscure regressions may remain to be found. Please help us to iron them out during the beta phase and release a great stable version.<li><p><strong>So will you be fixing immediately all the bugs? In fact, I'm reporting one at this very moment.</strong> Well... I'm going on vacation! So I may be a bit slow to respond in the next couple of weeks, sorry for that!</ul><h2>A bit of history</h2><p>On January, I had an online interview with <a href=https://www.youtube.com/channel/UCCQPh0mSMaVpRcKUeWPotSA>the Community for F#</a>. There I said that Fable was entering its third year which would become the consolidation year, where we wouldn't touch so much the compiler and focus instead in ecosystem, tutorials, etc. One week later <a href=https://github.com/fable-compiler/Fable/issues/1318>we started some discussion</a> to change the representation of types to reduce the size of the generated JS. Two weeks later I started work on Fable 2 with this purpose. Three weeks later I thought maybe this was a good opportunity to clean the code and started rewriting the whole code base... Yeah, I know, programmers.<h2>New design choices</h2><p>Moving six months forward (as usual longer than initially planned) we're finally very proud to announce the launch of Fable 2 beta! As mentioned above, the original intention was to compile records as plain JS objects and unions as arrays (similar to what <a href=https://bucklescript.github.io/>Bucklescript</a> does). However, at the end this hasn't been possible because we couldn't keep the full F# semantics this way (equality, <code>obj</code> method overrides, etc). Still we've managed to make types lighter, mainly because they don't include reflection info any more.<p>One of the original design decisions in Fable was to output readable and standard Javascript. This involved using ES2015 classes to represent types, avoid name mangling, reproducing module hierarchy, etc. However, we've realized this is not always desirable because the way of programming F# is not the same as programming JS, and we were creating some anti-patterns that didn't work well with JS tooling like bundlers or minifiers.<p>Fable 2 now will convert most of the methods (be it class or nested module members) into functions of the JS file module. This works much better with tree shaking and minification, though it involves more name mangling and somewhat diverges from the original goal of readable output. However Fable 2 performance results indicate it's worth it.<blockquote><p>Interfaces (and in some cases abstract classes) are still the main way to interact with JS code so abstract methods won't be mangled. Please avoid overloads in interfaces.</blockquote><p>We will go deeper about the differences in code output between Fable 1 and Fable 2 with examples in another post.<h2>Structural changes in Fable's code base</h2><p>I was going to write here about changes in Fable's code base, but I'm running out of time so I'll leave that for the next post too ;)<h2>Breaking changes</h2><ul><li><p><strong>Reflection</strong>: Not actually a breaking change as it still works basically the same, only reflection info is not attached to every type by default any more, instead it's generated by the compiler where needed (which should be transparent to most users). One side effect of this is <code>PassGenericsAttribute</code> is not needed any more and it's been marked as obsolete.<li><p><strong>PojoAttribute</strong>: This attribute was mainly intended to define <code>props</code> in React components, but same as <code>PassGenerics</code> it was kind of forking the F# language and changed the semantics of the type. So we've decided to turn it off in the beta. In our tests, the last version of React works just fine with Fable 2 records. Please give it a try and let us know if you've problems.<li><p><strong>JSON serialization</strong>: This was the most controversial thing in the discussions about Fable 2. JSON serialization was included in Fable.Core to make it easier for users to share types with the server, but now there are good alternatives and it was time to remove it. DON'T BE SCARED! Thanks to Maxime and Zaid, you still have auto-serializers to make the transition much easier, check <a href=https://mangelmaxime.github.io/Thoth/json/v2/decode.html#auto-decoder>Thoth.Json</a> and <a href=https://github.com/Zaid-Ajaj/Fable.SimpleJson>Fable.SimpleJson</a>.</ul><h2>Acknowledgments</h2><p>We had many great contributors during Fable 2 development, so I apologize in advance if I'm forgetting someone. If you like the improvements, please thank ncave and Maxime Mangel who have put a lot of work in this new release. But also Valery Vitko, Ilja Nosik, Zack Young, Zaid Ajaj and Aleksander Heintz.<p>And of course not only the compiler, the ecosystem arount it is very important to keep Fable alive, so big kudos from her to Eugene Tolmachev, Diego Esmerio, humhei, Kunjan Dalal, Stachu Korick, and the <a href=https://safe-stack.github.io/>SAFE-stack</a> team!<p>I also want to thank my employers, who trust Fable (and me!) and are really supportive to keep its development active: <a href=https://twitter.com/bentayloruk>Ben Taylor</a>, <a href=https://twitter.com/kuzrob>Robert Kuzelj</a> and <a href=https://demetrixbio.com/>Demetrix</a>.</p><br><p>That's all for today. Please give Fable 2 a shot - we've put a lot of love in it and hope you like it. Really excited to see what you will build with it!<p>Have a nice weekend and lovely Summer!</div></div></div></div></div></div><script async="" src="/resources/nacara-standard-layouts/scripts/menu.js"></script></body></html>